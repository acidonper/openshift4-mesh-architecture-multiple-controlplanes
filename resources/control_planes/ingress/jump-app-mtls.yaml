# Source: jump-app/charts/jump-app-micros/templates/istio/route.yaml
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: back-golang-jump-app-dev
  namespace: mesh-ingress
spec:
  host: back-golang-jump-app-dev.apps.test.sandbox1196.opentlc.com
  to:
    kind: Service
    name: istio-ingressgateway
  tls:
    termination: passthrough
    insecureEdgeTerminationPolicy: Redirect
  port:
    targetPort: https
---
# Source: jump-app/charts/jump-app-micros/templates/istio/route.yaml
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: front-javascript-jump-app-dev
  namespace: mesh-ingress
spec:
  host: front-javascript-jump-app-dev.apps.test.sandbox1196.opentlc.com
  to:
    kind: Service
    name: istio-ingressgateway
  tls:
    termination: passthrough
    insecureEdgeTerminationPolicy: Redirect
  port:
    targetPort: https
---
# Source: jump-app/charts/jump-app-micros/templates/istio/gateway.yaml
apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: back-golang
  namespace: mesh-ingress
spec:
  selector:
    istio: ingressgateway
  servers:
    - port:
        number: 443
        name: https
        protocol: HTTPS
      hosts:
      - back-golang-jump-app-dev.apps.test.sandbox1196.opentlc.com
      tls:
        mode: SIMPLE
        credentialName: istio-ssl-cp-secret
---
# Source: jump-app/charts/jump-app-micros/templates/istio/gateway.yaml
apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: front-javascript
  namespace: mesh-ingress
spec:
  selector:
    istio: ingressgateway
  servers:
    - port:
        number: 443
        name: https
        protocol: HTTPS
      hosts:
      - front-javascript-jump-app-dev.apps.test.sandbox1196.opentlc.com
      tls:
        mode: SIMPLE
        credentialName: istio-ssl-cp-secret
---
# Source: jump-app/charts/jump-app-micros/templates/istio/virtualservice.yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: back-golang
  namespace: mesh-ingress
spec:
  gateways:
  - back-golang
  hosts:
  - back-golang-jump-app-dev.apps.test.sandbox1196.opentlc.com
  http:
  - route:
      - destination:
          host: istio-ingressgateway.mesh-workload.svc.cluster.local
          subset: mtls
          port:
            number: 443
---
# Source: jump-app/charts/jump-app-micros/templates/istio/virtualservice.yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: front-javascript
  namespace: mesh-ingress
spec:
  gateways:
  - front-javascript
  hosts:
  - front-javascript-jump-app-dev.apps.test.sandbox1196.opentlc.com
  http:
  - route:
      - destination:
          host: istio-ingressgateway.mesh-workload.svc.cluster.local
          subset: mtls
          port:
            number: 443
---
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: back-golang
  namespace: mesh-ingress
spec:
  host: back-golang-jump-app-dev.apps.test.sandbox1196.opentlc.com
  subsets:
  - name: mtls
    trafficPolicy:
      tls:
        mode: MUTUAL
        clientCertificate: /etc/istio/mtls-certs/ingress.crt
        privateKey: /etc/istio/mtls-certs/ingress.key
        caCertificates: /etc/istio/mtls-certs/ca-cert.pem
---
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: istio-ingressgateway
  namespace: mesh-ingress
spec:
  host: istio-ingressgateway.mesh-workload.svc.cluster.local
  subsets:
  - name: mtls
    trafficPolicy:
      tls:
        mode: MUTUAL
        clientCertificate: /etc/istio/mtls-certs/ingress.crt
        privateKey: /etc/istio/mtls-certs/ingress.key
        caCertificates: /etc/istio/mtls-certs/ca-cert.pem
---
apiVersion: networking.istio.io/v1beta1
kind: ServiceEntry
metadata:
  name: mesh-workload
  namespace: mesh-ingress
spec:
  hosts:
  - istio-ingressgateway.mesh-workload.svc.cluster.local
  location: MESH_EXTERNAL
  ports:
  - number: 443
    name: https
    protocol: HTTPS
  resolution: DNS
